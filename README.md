# NetOps Flow

[![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)
[![Python 3.11](https://img.shields.io/badge/python-3.11-blue.svg)](https://www.python.org/downloads/)
[![Vue.js 3](https://img.shields.io/badge/Vue.js-3-4FC08D.svg)](https://vuejs.org/)
[![Docker](https://img.shields.io/badge/Docker-ready-2496ED.svg)](https://www.docker.com/)

> **Note**: This project was entirely generated by AI (Claude by Anthropic).

A self-hosted NetDevOps platform for network operations management, featuring IP Address Management (IPAM), inventory management, and script automation capabilities.

## Features

### IPAM (IP Address Management)
- Create and manage subnets with CIDR validation
- Allocate and track IP addresses within subnets
- Automatic subnet scanning using nmap to discover active hosts
- Track IP address status (active/available), hostname, and MAC address

### Script Runner
- Upload and manage Python (`.py`), Bash (`.sh`), and PowerShell (`.ps1`) scripts
- Execute scripts locally on the server or remotely via SSH/WinRM
- Docker sandboxing for secure local script execution
- Support for script arguments
- Real-time capture of stdout/stderr logs
- Execution status tracking (pending, running, success, failure, cancelled)
- Ability to stop running executions

### Inventory Management (GLPI-like)
- Complete equipment management: servers, switches, routers, firewalls, workstations, etc.
- Manufacturer and brand management with website links
- Equipment models with specifications (JSON)
- Equipment types with custom icons
- Location hierarchy: Site > Building > Room
- Supplier management with contact details
- Full tracking: serial number, asset tag, purchase date, warranty expiry
- Equipment status: In Service, In Stock, Retired, Maintenance
- Bidirectional IP-Equipment linking with IPAM integration
- Integrated DCIM placement: Add rack assignment, U-position, and height directly from equipment form
- Automatic rack list loading for seamless datacenter placement

### Network Topology
- Visual network topology display showing subnets and IP addresses
- Color-coded visualization (green for active IPs, gray for available)
- Physical topology based on network port connections

### DCIM (Data Center Infrastructure Management)
- Rack management with location assignment
- U-position (1-42) and height tracking for equipment
- PDU management with port allocation and power tracking
- Professional hardware-style rack visualization with metallic styling
- Status-based equipment color coding (blue=in service, orange=maintenance, gray=retired, green=stock)
- Dual U-number columns for realistic datacenter appearance
- Rich tooltips displaying model, manufacturer, S/N, asset tag, and management IP
- Unassigned equipment panel with drag-and-place functionality
- Conflict detection and validation for equipment placement
- Click-through navigation to equipment details in Inventory
- Context menu (right-click) on equipment for quick actions: View details, Change position, Remove from rack
- Real-time position editing directly from rack view
- Equipment removal from rack with confirmation dialog

### Contract Management
- Maintenance, insurance, and leasing contracts
- Link multiple equipment to contracts
- Automatic expiration alerts (30 days before)
- Annual cost and renewal tracking

### Software & License Management
- Software catalog with publisher and category
- License management (key, quantity, expiration)
- Installation tracking per equipment
- License compliance calculation (installations vs. quota)
- Automatic collection via SSH/WinRM

### Physical Connectivity
- Network ports per equipment (type, speed, MAC)
- Bidirectional port-to-port connections
- Complete switch-to-server mapping

### Document Management
- Attachments per equipment
- Document categorization
- Secure upload/download

### Multi-Tenant (Entities)
- Data isolation by entity
- Automatic API result filtering
- Entity management (admin only)

### Dashboard
- Statistics overview: total subnets, active IPs, scripts, executions, and equipment
- System status monitoring
- Quick action buttons for common tasks

### User Management
- User authentication with JWT tokens
- Role-based access control (admin/user)
- Granular permissions (IPAM, Topology, Scripts, Settings, Inventory)
- Admin can create and delete users
- Password validation (minimum 8 characters)

### Security
- JWT-based authentication with configurable secret
- Fernet symmetric encryption for sensitive data (passwords)
- CORS protection with configurable origins
- Redis-based distributed rate limiting
- Path traversal protection for file uploads
- Docker sandboxing for script execution
- Input validation and sanitization

### Internationalization
- Full support for English and French using vue-i18n (Composition API mode)
- Language preference persisted across sessions via localStorage
- Namespaced translation keys for maintainability (e.g., `dashboard.*`, `ipam.*`, `common.*`)
- Global injection enabled for seamless `t()` function access in all components

## Architecture

### Technology Stack

| Component | Technology |
|-----------|------------|
| **Backend API** | FastAPI (Python 3.11) with modular routers |
| **Task Queue** | Celery + Redis |
| **Database** | PostgreSQL 15 with SQLAlchemy ORM |
| **Migrations** | Alembic |
| **Frontend** | Vue.js 3 + Pinia + TailwindCSS + PrimeVue |
| **i18n** | vue-i18n |
| **Containerization** | Docker with multi-stage builds |

### Backend Structure

```
backend/
├── core/
│   ├── config.py       # Pydantic Settings configuration
│   ├── database.py     # SQLAlchemy engine & session
│   ├── security.py     # JWT, hashing, Fernet encryption
│   ├── rate_limiter.py # Redis-based rate limiting
│   └── logging.py      # Structured JSON logging
├── routers/
│   ├── auth.py         # Authentication endpoints
│   ├── users.py        # User management (admin)
│   ├── ipam.py         # IP Address Management
│   ├── inventory.py    # Equipment management
│   ├── scripts.py      # Script upload & execution
│   ├── topology.py     # Network visualization
│   ├── dashboard.py    # Statistics
│   ├── dcim.py         # Racks and PDUs management
│   ├── contracts.py    # Contract management
│   ├── software.py     # Software and licenses
│   ├── network_ports.py # Physical connectivity
│   ├── attachments.py  # File attachments
│   └── entities.py     # Multi-tenant entities
├── models.py           # SQLAlchemy models
├── schemas.py          # Pydantic schemas
└── app.py              # FastAPI application factory
```

### Frontend Structure

```
frontend/src/
├── components/
│   └── shared/         # Reusable components
├── stores/
│   ├── auth.js         # Authentication state (Pinia)
│   ├── ui.js           # UI preferences (Pinia)
│   ├── dcim.js         # DCIM state (Pinia)
│   ├── contracts.js    # Contracts state (Pinia)
│   ├── software.js     # Software state (Pinia)
│   ├── networkPorts.js # Network ports state (Pinia)
│   └── attachments.js  # Attachments state (Pinia)
├── i18n/
│   ├── index.js        # vue-i18n configuration
│   └── locales/        # EN/FR translations
├── views/              # Page components
├── api.js              # Axios client with interceptors
├── main.js             # Application entry point
└── router.js           # Vue Router configuration
```

## Getting Started

### Prerequisites

- Docker and Docker Compose
- Git

### Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/Arcneell/NetOps-Flow.git
   cd NetOps-Flow
   ```

2. Create a `.env` file (or copy from `.env.example`):
   ```bash
   cp .env.example .env
   ```

3. Generate secure keys:
   ```bash
   # Generate JWT secret
   openssl rand -base64 32

   # Generate Fernet encryption key
   python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
   ```

4. Run the stack:
   ```bash
   docker-compose up --build
   ```

5. Access the services:
   - **Frontend**: http://localhost:3000
   - **API Docs**: http://localhost:8000/docs

## Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `POSTGRES_USER` | Database username | `netops` |
| `POSTGRES_PASSWORD` | Database password | `netopspassword` |
| `POSTGRES_DB` | Database name | `netops_flow` |
| `JWT_SECRET_KEY` | Secret key for JWT tokens | (generated if not set) |
| `ENCRYPTION_KEY` | Fernet key for password encryption | (optional) |
| `ALLOWED_ORIGINS` | CORS allowed origins | `http://localhost:3000` |
| `VITE_API_URL` | Frontend API URL | `http://localhost:8000` |
| `LOG_LEVEL` | Logging level | `INFO` |
| `LOG_FORMAT` | Log format (text/json) | `text` |
| `DOCKER_SANDBOX_ENABLED` | Enable Docker sandboxing | `true` |
| `DOCKER_SANDBOX_IMAGE` | Sandbox Docker image | `netops-sandbox:latest` |
| `DOCKER_SANDBOX_MEMORY` | Sandbox memory limit | `256m` |
| `DOCKER_SANDBOX_CPU` | Sandbox CPU limit | `0.5` |

## Default Credentials

### Application Login
- **Username**: `admin`
- **Password**: `admin`

### Database
- **Username**: `netops`
- **Password**: `netopspassword`
- **Database**: `netops_flow`

> **Important**: Change the default credentials immediately after installation for security purposes.

## Development

### Running Alembic Migrations

```bash
# Create a new migration
docker-compose exec backend alembic revision --autogenerate -m "Description"

# Apply migrations
docker-compose exec backend alembic upgrade head

# Rollback one migration
docker-compose exec backend alembic downgrade -1
```

### Building the Sandbox Image

If Docker sandboxing is enabled, the sandbox image will be built automatically on first script execution. To build it manually:

```bash
docker build -t netops-sandbox:latest -f docker/sandbox.Dockerfile .
```

## Contributing

Contributions are welcome! Please read our [Contributing Guidelines](CONTRIBUTING.md) before submitting a Pull Request.

### How to Contribute

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## License

This project is licensed under the GNU General Public License v3.0 - see the [LICENSE](LICENSE) file for details.

## Support

If you encounter any issues or have questions, please [open an issue](https://github.com/Arcneell/NetOps-Flow/issues) on GitHub.
