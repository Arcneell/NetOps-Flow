import { reactive, computed } from 'vue';

const currentLang = reactive({ value: 'en' });

const translations = {
    en: {
        // Auth
        loginTitle: "NetOps Flow",
        loginSubtitle: "Enterprise Network Automation",
        username: "Username",
        password: "Password",
        signIn: "Sign In",
        accessGranted: "Access Granted",
        accessDenied: "Access Denied",
        welcomeBack: "Welcome back.",
        authOnly: "Authorized Access Only",

        // Sidebar
        dashboard: "Dashboard",
        network: "Network",
        ipam: "IPAM",
        topology: "Topology",
        automation: "Automation",
        scriptRunner: "Script Runner",
        system: "System",
        settings: "Settings",
        logout: "Logout",

        // Dashboard
        totalSubnets: "Total Subnets",
        activeIps: "Active IPs",
        scripts: "Scripts",
        executions: "Executions",
        totalEquipment: "Equipment",
        quickActions: "Quick Actions",
        systemStatus: "System Status",
        dbConnected: "Database Connected",
        workerActive: "Worker Active",
        newSubnet: "New Subnet",
        uploadScript: "Upload Script",

        // IPAM
        cidr: "CIDR",
        name: "Name",
        description: "Description",
        actions: "Actions",
        scanSubnet: "Scan Subnet",
        addIp: "Add IP",
        allocatedIps: "Allocated IPs in",
        address: "Address",
        hostname: "Hostname",
        mac: "MAC Address",
        lastScan: "Last Scan",
        status: "Status",
        noIps: "No IPs allocated or found yet. Click the Scan button.",
        save: "Save",
        cancel: "Cancel",
        allocate: "Allocate",
        manualIpAllocation: "Manual IP Allocation",
        ipAddress: "IP Address",
        subnetCreated: "Subnet Created",
        ipAllocated: "IP Allocated",
        scanStarted: "Scan Started",
        addressesFound: "addresses found",
        success: "Success",
        failedCreateSubnet: "Failed to create subnet",
        failedAllocateIp: "Failed to allocate IP",
        failedStartScan: "Failed to start scan",
        scanningBackground: "Scanning in background...",

        // Scripts
        uploadTitle: "Upload Script",
        availableScripts: "Available Scripts",
        executionHistory: "Execution History",
        clickDrag: "Click or drag file here",
        targetServer: "Target Server",
        localhost: "Localhost (Worker)",
        leaveEmpty: "Leave empty to run on the worker container.",
        runNow: "Run Now",
        enterPasswordConfirm: "Confirm Password to Execute",
        type: "Type",
        executionLog: "Execution Log",
        stdout: "STDOUT",
        stderr: "STDERR",
        uploaded: "Uploaded",
        error: "Error",
        started: "Started",
        scriptQueued: "Script execution queued",
        executionFailed: "Execution Failed",
        passwordRequired: "Password Required",
        confirmPasswordDetail: "Please confirm your password to execute.",
        delete: "Delete",
        deleted: "Deleted",
        scriptDeleted: "Script deleted successfully",
        scriptArgs: "Script Arguments",
        scriptArgsPlaceholder: "e.g. --verbose -n 5",
        fileSize: "File size",
        bytes: "bytes",
        invalidFileType: "Invalid file type. Only .py, .sh, .ps1 allowed.",
        stop: "Stop",
        deleteHistory: "Delete History",
        historyDeleted: "History Deleted",
        executionStopped: "Execution Stopped",
        accessDeniedTitle: "Access Denied",
        invalidPassword: "Invalid Password",
        invalidPasswordDetail: "The password you entered is incorrect.",
        confirmDeleteHistory: "Are you sure you want to delete the entire execution history?",
        confirmDeleteScript: "Are you sure you want to delete",

        // Settings
        myProfile: "My Profile",
        updatePassword: "Update Password",
        newPassword: "New Password",
        userManagement: "User Management",
        serverInventory: "Server Inventory",
        newUser: "New User",
        newServer: "New Server",
        role: "Role",
        permissions: "Permissions",
        saveUser: "Save User",
        saveServer: "Save Server",
        viewTopo: "View Topology",
        runScripts: "Run Scripts",
        accessSettings: "Access Settings",
        accessIpam: "Access IPAM",

        // User Management
        deleteUser: "Delete User",
        confirmDeleteUser: "Are you sure you want to delete user",
        userDeleted: "User deleted successfully",
        cannotDeleteSelf: "You cannot delete yourself",
        cannotDeleteLastAdmin: "Cannot delete the last admin",

        // Validation messages
        validationError: "Validation Error",
        usernameTooShort: "Username must be at least 3 characters",
        passwordTooShort: "Password must be at least 8 characters",
        fillRequiredFields: "Please fill all required fields",
        userCreated: "User created successfully",
        passwordUpdated: "Password updated successfully",
        updateFailed: "Update Failed",

        // 403 Unauthorized page
        unauthorizedTitle: "Access Denied",
        unauthorizedSubtitle: "You don't have permission to access this page",
        unauthorizedMessage: "Please contact your administrator if you believe this is an error.",
        goBack: "Go Back",
        goHome: "Go to Dashboard",

        // Inventory
        inventory: "Inventory",
        equipment: "Equipment",
        equipmentList: "Equipment List",
        newEquipment: "New Equipment",
        editEquipment: "Edit Equipment",
        manufacturer: "Manufacturer",
        manufacturers: "Manufacturers",
        newManufacturer: "New Manufacturer",
        equipmentModel: "Model",
        equipmentModels: "Models",
        newModel: "New Model",
        equipmentType: "Type",
        equipmentTypes: "Types",
        newType: "New Type",
        location: "Location",
        locations: "Locations",
        newLocation: "New Location",
        supplier: "Supplier",
        suppliers: "Suppliers",
        newSupplier: "New Supplier",
        serialNumber: "Serial Number",
        assetTag: "Asset Tag",
        purchaseDate: "Purchase Date",
        warrantyExpiry: "Warranty Expiry",
        notes: "Notes",
        website: "Website",
        phone: "Phone",
        contactEmail: "Contact Email",
        site: "Site",
        building: "Building",
        room: "Room",
        icon: "Icon",
        specs: "Specifications",

        // Equipment Status
        inService: "In Service",
        inStock: "In Stock",
        retired: "Retired",
        maintenance: "Maintenance",

        // IP Linking
        linkedIps: "Linked IPs",
        linkIp: "Link IP",
        unlinkIp: "Unlink IP",
        noIpLinked: "No IP linked",
        availableIps: "Available IPs",
        selectIp: "Select an IP",
        ipLinked: "IP linked successfully",
        ipUnlinked: "IP unlinked successfully",

        // Inventory messages
        equipmentCreated: "Equipment created successfully",
        equipmentUpdated: "Equipment updated successfully",
        equipmentDeleted: "Equipment deleted successfully",
        manufacturerCreated: "Manufacturer created successfully",
        manufacturerDeleted: "Manufacturer deleted successfully",
        modelCreated: "Model created successfully",
        modelDeleted: "Model deleted successfully",
        typeCreated: "Type created successfully",
        typeDeleted: "Type deleted successfully",
        locationCreated: "Location created successfully",
        locationDeleted: "Location deleted successfully",
        supplierCreated: "Supplier created successfully",
        supplierDeleted: "Supplier deleted successfully",
        cannotDeleteHasItems: "Cannot delete: has associated items",

        // Inventory permission
        accessInventory: "Access Inventory",

        // Filters
        filterByType: "Filter by type",
        filterByStatus: "Filter by status",
        filterByLocation: "Filter by location",
        allTypes: "All types",
        allStatuses: "All statuses",
        allLocations: "All locations",
        noEquipment: "No equipment found",
        totalEquipment: "Total Equipment",
        configuration: "Configuration",
        edit: "Edit",
        details: "Details",
        confirmDelete: "Confirm Delete",
        confirmDeleteEquipment: "Are you sure you want to delete this equipment?",
        confirmDeleteItem: "Are you sure you want to delete this item?",
        noAvailableIps: "No available IPs to link",
        linkedEquipment: "Linked Equipment",

        // Remote Execution
        supportsRemoteExecution: "Supports Remote Execution",
        remoteExecution: "Remote Execution",
        remoteIp: "Remote IP",
        remotePort: "Port",
        osType: "OS Type",
        connectionType: "Connection Type",

        // New modules navigation
        dcim: "DCIM",
        contracts: "Contracts",
        software: "Software"
    },
    fr: {
        // Auth
        loginTitle: "NetOps Flow",
        loginSubtitle: "Automatisation RÃ©seau",
        username: "Nom d'utilisateur",
        password: "Mot de passe",
        signIn: "Connexion",
        accessGranted: "AccÃ¨s AutorisÃ©",
        accessDenied: "AccÃ¨s RefusÃ©",
        welcomeBack: "Bon retour.",
        authOnly: "AccÃ¨s AutorisÃ© Uniquement",

        // Sidebar
        dashboard: "Tableau de bord",
        network: "RÃ©seau",
        ipam: "IPAM",
        topology: "Topologie",
        automation: "Automatisation",
        scriptRunner: "ExÃ©cution de Scripts",
        system: "SystÃ¨me",
        settings: "ParamÃ¨tres",
        logout: "DÃ©connexion",

        // Dashboard
        totalSubnets: "Sous-rÃ©seaux",
        activeIps: "IPs Actives",
        scripts: "Scripts",
        executions: "ExÃ©cutions",
        totalEquipment: "Ã‰quipements",
        quickActions: "Actions Rapides",
        systemStatus: "Ã‰tat du SystÃ¨me",
        dbConnected: "Base de donnÃ©es connectÃ©e",
        workerActive: "Worker Actif",
        newSubnet: "Nouveau Sous-rÃ©seau",
        uploadScript: "Uploader un Script",

        // IPAM
        cidr: "CIDR",
        name: "Nom",
        description: "Description",
        actions: "Actions",
        scanSubnet: "Scanner",
        addIp: "Ajouter IP",
        allocatedIps: "IPs allouÃ©es dans",
        address: "Adresse",
        hostname: "Nom d'hÃ´te",
        mac: "Adresse MAC",
        lastScan: "Dernier Scan",
        status: "Statut",
        noIps: "Aucune IP trouvÃ©e. Cliquez sur le bouton Scan.",
        save: "Enregistrer",
        cancel: "Annuler",
        allocate: "Allouer",
        manualIpAllocation: "Allocation IP Manuelle",
        ipAddress: "Adresse IP",
        subnetCreated: "Sous-rÃ©seau CrÃ©Ã©",
        ipAllocated: "IP AllouÃ©e",
        scanStarted: "Scan DÃ©marrÃ©",
        addressesFound: "adresses trouvÃ©es",
        success: "SuccÃ¨s",
        failedCreateSubnet: "Ã‰chec crÃ©ation sous-rÃ©seau",
        failedAllocateIp: "Ã‰chec allocation IP",
        failedStartScan: "Ã‰chec dÃ©marrage scan",
        scanningBackground: "Scan en arriÃ¨re-plan...",

        // Scripts
        uploadTitle: "Uploader un Script",
        availableScripts: "Scripts Disponibles",
        executionHistory: "Historique",
        clickDrag: "Cliquez ou glissez un fichier ici",
        targetServer: "Serveur Cible",
        localhost: "Localhost (Worker)",
        leaveEmpty: "Laisser vide pour exÃ©cution locale.",
        runNow: "ExÃ©cuter",
        enterPasswordConfirm: "Confirmez mot de passe pour exÃ©cuter",
        type: "Type",
        executionLog: "Journal d'ExÃ©cution",
        stdout: "STDOUT",
        stderr: "STDERR",
        uploaded: "TÃ©lÃ©versÃ©",
        error: "Erreur",
        started: "DÃ©marrÃ©",
        scriptQueued: "ExÃ©cution du script en file d'attente",
        executionFailed: "Ã‰chec de l'exÃ©cution",
        passwordRequired: "Mot de passe requis",
        confirmPasswordDetail: "Veuillez confirmer votre mot de passe pour exÃ©cuter.",
        delete: "Supprimer",
        deleted: "SupprimÃ©",
        scriptDeleted: "Script supprimÃ© avec succÃ¨s",
        scriptArgs: "Arguments du script",
        scriptArgsPlaceholder: "ex: --verbose -n 5",
        fileSize: "Taille du fichier",
        bytes: "octets",
        invalidFileType: "Type de fichier invalide. Seuls .py, .sh, .ps1 autorisÃ©s.",
        stop: "ArrÃªter",
        deleteHistory: "Effacer l'historique",
        historyDeleted: "Historique effacÃ©",
        executionStopped: "ExÃ©cution arrÃªtÃ©e",
        accessDeniedTitle: "AccÃ¨s RefusÃ©",
        invalidPassword: "Mot de passe incorrect",
        invalidPasswordDetail: "Le mot de passe que vous avez entrÃ© est incorrect.",
        confirmDeleteHistory: "ÃŠtes-vous sÃ»r de vouloir effacer tout l'historique d'exÃ©cution ?",
        confirmDeleteScript: "ÃŠtes-vous sÃ»r de vouloir supprimer",

        // Settings
        myProfile: "Mon Profil",
        updatePassword: "Changer mot de passe",
        newPassword: "Nouveau mot de passe",
        userManagement: "Utilisateurs",
        serverInventory: "Inventaire Serveurs",
        newUser: "Nouvel Utilisateur",
        newServer: "Nouveau Serveur",
        role: "RÃ´le",
        permissions: "Permissions",
        saveUser: "Enregistrer",
        saveServer: "Enregistrer",
        viewTopo: "Voir Topologie",
        runScripts: "Lancer Scripts",
        accessSettings: "AccÃ¨s ParamÃ¨tres",
        accessIpam: "AccÃ¨s IPAM",

        // User Management
        deleteUser: "Supprimer l'utilisateur",
        confirmDeleteUser: "ÃŠtes-vous sÃ»r de vouloir supprimer l'utilisateur",
        userDeleted: "Utilisateur supprimÃ© avec succÃ¨s",
        cannotDeleteSelf: "Vous ne pouvez pas vous supprimer vous-mÃªme",
        cannotDeleteLastAdmin: "Impossible de supprimer le dernier administrateur",

        // Validation messages
        validationError: "Erreur de validation",
        usernameTooShort: "Le nom d'utilisateur doit contenir au moins 3 caractÃ¨res",
        passwordTooShort: "Le mot de passe doit contenir au moins 8 caractÃ¨res",
        fillRequiredFields: "Veuillez remplir tous les champs obligatoires",
        userCreated: "Utilisateur crÃ©Ã© avec succÃ¨s",
        passwordUpdated: "Mot de passe mis Ã  jour avec succÃ¨s",
        updateFailed: "Ã‰chec de la mise Ã  jour",

        // 403 Unauthorized page
        unauthorizedTitle: "AccÃ¨s RefusÃ©",
        unauthorizedSubtitle: "Vous n'avez pas la permission d'accÃ©der Ã  cette page",
        unauthorizedMessage: "Veuillez contacter votre administrateur si vous pensez qu'il s'agit d'une erreur.",
        goBack: "Retour",
        goHome: "Aller au tableau de bord",

        // Inventory
        inventory: "Inventaire",
        equipment: "Ã‰quipement",
        equipmentList: "Liste des Ã©quipements",
        newEquipment: "Nouvel Ã©quipement",
        editEquipment: "Modifier l'Ã©quipement",
        manufacturer: "Fabricant",
        manufacturers: "Fabricants",
        newManufacturer: "Nouveau fabricant",
        equipmentModel: "ModÃ¨le",
        equipmentModels: "ModÃ¨les",
        newModel: "Nouveau modÃ¨le",
        equipmentType: "Type",
        equipmentTypes: "Types",
        newType: "Nouveau type",
        location: "Emplacement",
        locations: "Emplacements",
        newLocation: "Nouvel emplacement",
        supplier: "Fournisseur",
        suppliers: "Fournisseurs",
        newSupplier: "Nouveau fournisseur",
        serialNumber: "NumÃ©ro de sÃ©rie",
        assetTag: "Code inventaire",
        purchaseDate: "Date d'achat",
        warrantyExpiry: "Fin de garantie",
        notes: "Notes",
        website: "Site web",
        phone: "TÃ©lÃ©phone",
        contactEmail: "Email de contact",
        site: "Site",
        building: "BÃ¢timent",
        room: "Salle",
        icon: "IcÃ´ne",
        specs: "SpÃ©cifications",

        // Equipment Status
        inService: "En service",
        inStock: "En stock",
        retired: "RetirÃ©",
        maintenance: "En maintenance",

        // IP Linking
        linkedIps: "IPs liÃ©es",
        linkIp: "Lier une IP",
        unlinkIp: "DÃ©lier l'IP",
        noIpLinked: "Aucune IP liÃ©e",
        availableIps: "IPs disponibles",
        selectIp: "SÃ©lectionner une IP",
        ipLinked: "IP liÃ©e avec succÃ¨s",
        ipUnlinked: "IP dÃ©liÃ©e avec succÃ¨s",

        // Inventory messages
        equipmentCreated: "Ã‰quipement crÃ©Ã© avec succÃ¨s",
        equipmentUpdated: "Ã‰quipement mis Ã  jour avec succÃ¨s",
        equipmentDeleted: "Ã‰quipement supprimÃ© avec succÃ¨s",
        manufacturerCreated: "Fabricant crÃ©Ã© avec succÃ¨s",
        manufacturerDeleted: "Fabricant supprimÃ© avec succÃ¨s",
        modelCreated: "ModÃ¨le crÃ©Ã© avec succÃ¨s",
        modelDeleted: "ModÃ¨le supprimÃ© avec succÃ¨s",
        typeCreated: "Type crÃ©Ã© avec succÃ¨s",
        typeDeleted: "Type supprimÃ© avec succÃ¨s",
        locationCreated: "Emplacement crÃ©Ã© avec succÃ¨s",
        locationDeleted: "Emplacement supprimÃ© avec succÃ¨s",
        supplierCreated: "Fournisseur crÃ©Ã© avec succÃ¨s",
        supplierDeleted: "Fournisseur supprimÃ© avec succÃ¨s",
        cannotDeleteHasItems: "Impossible de supprimer : Ã©lÃ©ments associÃ©s",

        // Inventory permission
        accessInventory: "AccÃ¨s Inventaire",

        // Filters
        filterByType: "Filtrer par type",
        filterByStatus: "Filtrer par statut",
        filterByLocation: "Filtrer par emplacement",
        allTypes: "Tous les types",
        allStatuses: "Tous les statuts",
        allLocations: "Tous les emplacements",
        noEquipment: "Aucun Ã©quipement trouvÃ©",
        totalEquipment: "Total Ã‰quipements",
        configuration: "Configuration",
        edit: "Modifier",
        details: "DÃ©tails",
        confirmDelete: "Confirmer la suppression",
        confirmDeleteEquipment: "ÃŠtes-vous sÃ»r de vouloir supprimer cet Ã©quipement ?",
        confirmDeleteItem: "ÃŠtes-vous sÃ»r de vouloir supprimer cet Ã©lÃ©ment ?",
        noAvailableIps: "Aucune IP disponible Ã  lier",
        linkedEquipment: "Ã‰quipement liÃ©",

        // Remote Execution
        supportsRemoteExecution: "Supporte l'exÃ©cution Ã  distance",
        remoteExecution: "ExÃ©cution Ã  distance",
        remoteIp: "IP distante",
        remotePort: "Port",
        osType: "Type d'OS",
        connectionType: "Type de connexion",

        // New modules navigation
        dcim: "DCIM",
        contracts: "Contrats",
        software: "Logiciels"
    }
};

// Returns a computed ref (use .value in script, or unwrap in template)
export const t = (key) => {
    return computed(() => translations[currentLang.value][key] || key);
};

export const setLang = (lang) => {
    if (lang === 'en' || lang === 'fr') {
        currentLang.value = lang;
        localStorage.setItem('lang', lang);
    }
};

export const toggleLang = () => {
    currentLang.value = currentLang.value === 'en' ? 'fr' : 'en';
    localStorage.setItem('lang', currentLang.value);
};

export const initLang = () => {
    const saved = localStorage.getItem('lang');
    if (saved) currentLang.value = saved;
};

export const getCurrentLang = () => currentLang.value;

export const langIcon = computed(() => currentLang.value === 'en' ? 'ğŸ‡«ğŸ‡·' : 'ğŸ‡ºğŸ‡¸');
